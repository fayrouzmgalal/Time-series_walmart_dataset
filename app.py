# -*- coding: utf-8 -*-
"""app

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1XKNADHu_ODrz0MDu5Dtj79xxGFvhmjdq
"""

import streamlit as st
import pandas as pd
import joblib
from datetime import datetime, timedelta

import pandas as pd
import numpy as np
from statsmodels.tsa.holtwinters import ExponentialSmoothing


df = pd.read_csv("C:\\Users\\fayro\\Downloads\\Rec.sys\\project_dataset.csv", parse_dates=['Date'], index_col='Date')

data = df[df['Dept'] == 29].copy()

data = data.sort_index()

model = ExponentialSmoothing(
    data['Weekly_Sales'],
    trend='add',
    seasonal='add',
    seasonal_periods=52
).fit()



# Title
st.title(" Department 29 â€“ Weekly Sales Forecast")
st.write("Forecasting weekly sales using Holt-Winters Additive Model")

# Input
st.subheader(" Choose a week to forecast:")
n_weeks = st.number_input("Number of weeks ahead", min_value=1, max_value=52, value=1)

# Predict
if st.button("Predict Weekly Sales"):
    forecast = model.forecast(n_weeks)
    future_dates = pd.date_range(start='2012-10-26', periods=n_weeks+1, freq='W')[1:]

    forecast_df = pd.DataFrame({
        "Date": future_dates,
        "Predicted Weekly Sales": forecast
    })

    st.success("Prediction completed!")
    st.write(forecast_df)

    st.line_chart(forecast_df.set_index("Date"))